func getInputByte():word{
    asm{
        "lda #%10000001     ; Set NMI enable bit and joypad"
         "sta $4200"
         "WaitForUserInput:"
         "lda $4212"
         "and #1"
         "bne WaitForUserInput   ;Wait for input unless we have the input"
         "lda $4219          ;Load input into the accumulator then return (compiler adds it)"
    }
}

func frame(){
    asm{"wai"}  //Wait for VBlank, then return
}

playerXPosition: word = 64
buffer: word[10]

load playerSprites, playerPalettes from "src/main/littleGuy.png"

globDat: word[20]
globDat2: word[20]

func main(){
    playing: bool = true

    for i:word = 0; i < 20; i = i + 1 do
        globDat[i] = i

    for i:word = 0; i < 20; i = i + 1 do{
        mid:word = globDat[i]
        globDat2[i] = mid + mid
    }

    while playing do{
        inputByte: word = getInputByte()
        if (inputByte and 4) > 0 then playing = false
        else{
            if (inputByte and 1) > 0 then
                playerXPosition = playerXPosition + 1
            else if (inputByte and 2) > 0 then
                playerXPosition = 1 - playerXPosition
        }
        frame()
    }
    asm{"stp    ;stop the processor from running"}
}